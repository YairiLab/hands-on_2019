<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>Hands-on Workshop</title>
    <link rel="stylesheet" type="text/css" href="ress.css" />
    <link rel="stylesheet" type="text/css" href="js_practice_style.css" />
  </head>

  <body>
    <header>
      <h1>Hands-on Workshop</h1>
    </header>

    <main>
      <section id="rotate-boxes">
        <div id="rotate-boxes__wrapper">
          <div id="red-box"></div>
          <div id="green-box"></div>
          <div id="blue-box"></div>
          <div id="yellow-box"></div>
          <div id="orange-box"></div>
          <div id="pink-box"></div>
          <div id="purple-box"></div>
        </div>
        <button id="rotate-boxes__button">rotate</button>
      </section>

      <section id="favorite-food">
        <h2 id="favorite-food__title">好きな食べ物</h2>

        <form id="add-favorite-form">
          <input type="text" id="new-favorite" name="newFav" />
          <input type="button" id="add-favorite-button" value="追加する" onclick="addNewFavorite()" />
        </form>

        <ul id="favorite-food__list">
          <li>カレー</li>
          <li>ラーメン</li>
          <li>ハンバーグ</li>
          <li>芋焼酎</li>
        </ul>
      </section>
    </main>

    <footer>
      <p>@ Yairi Lab</p>
    </footer>

    <script>
      // ボックスのローテーション
      let rotateBoxes = () => {
        let boxWrapper = document.getElementById("rotate-boxes__wrapper");
        let lastBox = boxWrapper.firstElementChild;
        boxWrapper.removeChild(lastBox);
        boxWrapper.appendChild(lastBox);
      };
      let rotateButton = document.getElementById("rotate-boxes__button");
      rotateButton.addEventListener("click", rotateBoxes, false);

      // 好きな食べ物の追加
      // 読み込みが完了したらローカルストレージから好きな食べ物を取ってくる
      let favoriteFoodFromLocalStorage;
      window.onload = () => {
        favoriteFoodFromLocalStorage = localStorage.getItem("myFavoriteFood");
        if (favoriteFoodFromLocalStorage) {
          let favoriteFoodList = favoriteFoodFromLocalStorage.split(",");
          favoriteFoodList.forEach(favoriteFood => {
            addNewListItemToFavoriteList(favoriteFood);
          });
        }
      };

      // liを作ってulの一番最後に挿入する関数
      function addNewListItemToFavoriteList(favoriteFood) {
        let listItem = document.createElement("li");
        listItem.textContent = favoriteFood;
        let favoriteFoodList = document.getElementById("favorite-food__list");
        favoriteFoodList.appendChild(listItem);
      }

      // フォームに入力されてたらその文字列をリストに追加したあと、ローカルストレージにもセット
      function addNewFavorite() {
        let newFavoriteForm = document.getElementById("add-favorite-form");
        let newFavorite = newFavoriteForm.newFav.value;
        if (newFavorite) {
          addNewListItemToFavoriteList(newFavorite);
          favoriteFoodFromLocalStorage ? (favoriteFoodFromLocalStorage += "," + newFavorite) : (favoriteFoodFromLocalStorage = newFavorite);
          localStorage.setItem("myFavoriteFood", favoriteFoodFromLocalStorage);
          newFavoriteForm.reset();
        } else {
          alert("好きな食べ物を入力してください");
        }
      }
    </script>
  </body>
</html>
